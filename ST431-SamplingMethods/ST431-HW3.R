# Problem 3.7
bio <- c(0,1,1,3,5,5,7)
phys <- c(0,0,0,0,0,0,0,0,0,0,1,1,3,4,4,5,6,8,8)
soc <- c(0,0,0,0,0,0,0,0,0,2,4,4,6)
hum <- c(0,0,0,0,0,0,0,0,1,1,3)
# t.str
mean(bio)*102 + mean(phys)*310 + mean(soc)*217 + mean(hum)*178
# SE
sqrt(sum((1-7/102)*(var(bio)/7)*(102)^2 + 
            (1-19/310)*(var(phys)/19)*(310)^2 +
            (1-13/217)*(var(soc)/13)*(217)^2 +
            (1-11/178)*(var(hum)/11)*(178)^2))

# p hat
(102/807)*(1/7) + (310/807)*(10/19) + (217/807)*(9/13) + (178/807)*(8/11)
# SE p hat
sum((1-7/102)*(1/7)*(1-1/7)*(102/807)^2/(7-1),
    (1-19/310)*(10/19)*(1-10/19)*(310/807)^2/(19-1),
    (1-13/217)*(9/13)*(1-9/13)*(217/807)^2/(13-1),
    (1-11/178)*(8/11)*(1-8/11)*(178/807)^2/(11-1))

# Problem 3.8
n.phone <- (0.9/sqrt(10))/(0.9/sqrt(10) + 0.1/sqrt(40))
n.nophone <- (0.1/sqrt(40))/(0.9/sqrt(10) + 0.1/sqrt(40))
n <- 15000/(10*0.947 + 40*0.0526)
n*n.phone
n*n.nophone

# Problem 3.10
t.hat <- 25.6*222.81*.44 + 
        25.6*49.61*1.17 + 
        25.6*50.25*3.92 +
        25.6*197.81*1.80

SE <- sqrt((1-4/(25.6*222.81)*(0.068/4)*(25.6*222.81)^2) +
           ((1-6/(25.6*49.61))*(0.042/6)*(25.6*49.61)^2) +
           ((1-3/(25.6*50.25))*(2.146/3)*(25.6*50.25)^2) +
           ((1-5/(25.6*197.81))*(0.794/5)*(25.6*197.81)^2))

# With combined statum
t.hat <- 25.6*322.67*0.63 + 25.6*197.81*.4

SE <- sqrt((1-8/(25.6*322.67))*(0.083/8)*(25.6*322.67)^2 +
                   (1-5/(25.6*197.81))*(0.046/5)*(25.6*197.81)^2)


# Problem 3.12
denom <- 21*7647472708 + 103*29618183543 + 135*53587487856 + 41*396185950266
n.ne <- (21*7647472708*300)/denom
n.nc <- (103*29618183543*300)/denom
n.s <- (135*53587487856*300)/denom
n.w <- (41*396185950266*300)/denom

# Problem 4.3
x <- c(12, 11.4, 7.9, 9, 10.5, 7.9, 7.3, 10.2, 11.7, 11.3, 5.7, 8, 10.3, 12, 9.2, 8.5, 7, 10.7, 9.3, 8.2)
y <- c(125, 119, 83, 85, 99, 117, 69, 133, 154, 168, 61, 80, 114, 147, 122, 106, 82, 88, 97, 99)
plot(x,y, xlab = 'Diameter', ylab = 'Age', main = 'Tree Trunk Diameter vs Age')
B <- mean(y)/mean(x)
s2 <- (1/19)*sum((y - B*x - (mean(y) - B*mean(x)))^2)
SE <- sqrt((1-20/1132)*(s2/20)*(10.3/mean(x)))
# Regression estimation


# Problem 4.8
agsrs <- read.csv('C:\\Users\\Jeremy\\OneDrive\\Fall 2016\\ST 431\\agsrs.csv')
hist(agsrs$farms87, sqrt(300), xlab = 'Number of Famrs', main = 'Number of Farms Per County in 1987')
plot(agsrs$farms87, agsrs$farms92, xlab = 'Farms By County in 1987', ylab = 'Farms By County in 1992', main = 'Farms By County in 1987 vs 1992')
B <- sum(agsrs$farms92)/sum(agsrs$farms87)
y.est92 <- B*sum(agsrs$acres87)
